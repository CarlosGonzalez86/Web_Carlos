<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>StreamFlix - Películas en Streamers</title>
<style>
  /* Reset and base */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #121212, #1f1f1f);
    color: #eee;
    display: flex;
    flex-direction: column;
    min-height: 600px;
    max-width: 350px;
    margin: auto;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 0 15px rgba(0,0,0,0.9);
  }
  header {
    background: #e50914;
    padding: 1rem;
    text-align: center;
    font-weight: 700;
    font-size: 1.5rem;
    letter-spacing: 2px;
    user-select: none;
  }
  main {
    flex: 1;
    overflow-y: auto;
    padding: 0.75rem 1rem 1rem 1rem;
  }
  #searchBar {
    width: 100%;
    padding: 8px 12px;
    border-radius: 4px;
    border: none;
    margin-bottom: 1rem;
    font-size: 1rem;
    font-weight: 600;
  }
  #moviesList {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }
  .movie-card {
    background: #222;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 8px rgb(0 0 0 / 0.7);
    display: flex;
    flex-direction: column;
    cursor: pointer;
    transition: transform 0.15s ease;
  }
  .movie-card:hover {
    transform: scale(1.05);
  }
  .movie-thumb {
    width: 100%;
    object-fit: cover;
    height: 120px;
  }
  .movie-info {
    padding: 0.5rem;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  .movie-title {
    font-size: 1rem;
    font-weight: 700;
    margin-bottom: 0.25rem;
    text-align: center;
  }
  .watch-btn {
    background: #e50914;
    border: none;
    color: white;
    font-weight: 700;
    padding: 6px 0;
    border-radius: 4px;
    cursor: pointer;
    width: 100%;
    font-size: 0.9rem;
    user-select: none;
  }
  .watch-btn:hover {
    background: #b0060f;
  }

  /* Modal styles */
  #modalOverlay {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0,0,0,0.8);
    display: none;
    justify-content: center;
    align-items: center;
    padding: 1rem;
    z-index: 999;
  }
  #modalContent {
    background: #121212;
    padding: 1rem;
    border-radius: 8px;
    max-width: 320px;
    width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
  }
  #modalContent iframe {
    width: 100%;
    height: 180px;
    border-radius: 6px;
  }
  #modalClose {
    position: absolute;
    top: 10px;
    right: 12px;
    font-size: 1.5rem;
    color: #fff;
    font-weight: 700;
    cursor: pointer;
    user-select: none;
  }
  #streamLinks {
    margin-top: 1rem;
  }
  .stream-link {
    display: block;
    background: #e50914;
    color: white;
    text-decoration: none;
    padding: 0.5rem;
    border-radius: 4px;
    margin-bottom: 0.5rem;
    text-align: center;
    font-weight: 700;
  }
  .stream-link:hover {
    background: #b0060f;
  }
  footer {
    text-align: center;
    font-size: 0.8rem;
    padding: 0.7rem;
    color: #666;
    user-select:none;
  }
  @media (max-width: 360px) {
    body {
      max-width: 100vw;
      border-radius: 0;
      min-height: 100vh;
    }
    #modalContent iframe {
      height: 160px;
    }
  }
</style>
</head>
<body>
<header>StreamFlix</header>
<main>
  <input id="searchBar" type="search" placeholder="Buscar película..." aria-label="Buscar película" />
  <div id="moviesList" aria-live="polite" aria-relevant="additions"></div>
</main>

<div id="modalOverlay" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
  <div id="modalContent">
    <span id="modalClose" role="button" aria-label="Cerrar">×</span>
    <h2 id="modalTitle"></h2>
    <div id="videoContainer"></div>
    <div id="streamLinks"></div>
  </div>
</div>

<footer>© 2024 StreamFlix - App de ejemplo con películas en streamers</footer>

<script>
  const movies = [
    {
      id: 1,
      title: "Big Buck Bunny",
      thumbnail: "https://peach.blender.org/wp-content/uploads/title_anouncement.jpg?x11217",
      streams: [
        {name: "YouTube", url: "https://www.youtube.com/embed/YE7VzlLtp-4"},
        {name: "Vimeo", url: "https://player.vimeo.com/video/45954802"}
      ]
    },
    {
      id: 2,
      title: "Sintel",
      thumbnail: "https://media.wired.com/photos/59265275734dcf5f91be0ebb/master/pass/sintel-blender-movie.jpg",
      streams: [
        {name: "YouTube", url: "https://www.youtube.com/embed/eRsGyueVLvQ"},
      ]
    },
    {
      id: 3,
      title: "Tears of Steel",
      thumbnail: "https://mango.blender.org/wp-content/themes/mango/img/tears-of-steel-poster.jpg",
      streams: [
        {name: "YouTube", url: "https://www.youtube.com/embed/uc08Lf35iN8"}
      ]
    },
    {
      id: 4,
      title: "Trailer Interstellar",
      thumbnail: "https://m.media-amazon.com/images/I/81kzKFlgZ1L._SL1500_.jpg",
      streams: [
        {name: "YouTube", url: "https://www.youtube.com/embed/zSWdZVtXT7E"}
      ]
    },
    {
      id: 5,
      title: "Trailer Inception",
      thumbnail: "https://m.media-amazon.com/images/I/51s+O96QjgL._AC_.jpg",
      streams: [
        {name: "YouTube", url: "https://www.youtube.com/embed/YoHD9XEInc0"}
      ]
    }
  ];

  const moviesList = document.getElementById('moviesList');
  const searchBar = document.getElementById('searchBar');
  const modalOverlay = document.getElementById('modalOverlay');
  const modalClose = document.getElementById('modalClose');
  const modalTitle = document.getElementById('modalTitle');
  const videoContainer = document.getElementById('videoContainer');
  const streamLinks = document.getElementById('streamLinks');

  function createMovieCard(movie) {
    const card = document.createElement('div');
    card.className = 'movie-card';
    card.tabIndex = 0;
    card.setAttribute('role', 'button');
    card.setAttribute('aria-pressed', 'false');
    card.setAttribute('aria-label', `Ver ${movie.title}`);

    card.innerHTML = `
      <img class="movie-thumb" src="${movie.thumbnail}" alt="Portada ${movie.title}" />
      <div class="movie-info">
        <div class="movie-title">${movie.title}</div>
        <button class="watch-btn" aria-label="Ver ${movie.title}">Ver</button>
      </div>
    `;

    const btn = card.querySelector('.watch-btn');
    btn.addEventListener('click', () => openPlayer(movie));
    card.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        openPlayer(movie);
      }
    });

    return card;
  }

  function openPlayer(movie) {
    modalTitle.textContent = movie.title;
    videoContainer.innerHTML = '';
    streamLinks.innerHTML = '';

    if (movie.streams.length === 1) {
      // Embed the video directly if only one stream
      const iframe = document.createElement('iframe');
      iframe.src = movie.streams[0].url + "?autoplay=1&rel=0";
      iframe.title = movie.title;
      iframe.setAttribute('allowfullscreen', '');
      iframe.setAttribute('allow', 'autoplay; fullscreen; picture-in-picture');
      videoContainer.appendChild(iframe);
    } else {
      // If multiple streams, show links and embed first one
      const iframe = document.createElement('iframe');
      iframe.src = movie.streams[0].url + "?autoplay=1&rel=0";
      iframe.title = movie.title;
      iframe.setAttribute('allowfullscreen', '');
      iframe.setAttribute('allow', 'autoplay; fullscreen; picture-in-picture');
      videoContainer.appendChild(iframe);

      movie.streams.forEach(stream => {
        const a = document.createElement('a');
        a.href = stream.url;
        a.target = "_blank";
        a.rel = "noopener noreferrer";
        a.className = 'stream-link';
        a.textContent = `Ver en ${stream.name}`;
        streamLinks.appendChild(a);
      });
    }
    modalOverlay.style.display = 'flex';
    modalOverlay.focus();
  }

  function closePlayer() {
    modalOverlay.style.display = 'none';
    videoContainer.innerHTML = '';
    streamLinks.innerHTML = '';
  }

  modalClose.addEventListener('click', closePlayer);
  modalOverlay.addEventListener('click', (e) => {
    if(e.target === modalOverlay) {
      closePlayer();
    }
  });

  searchBar.addEventListener('input', () => {
    renderMovies(searchBar.value.toLowerCase());
  });

  function renderMovies(searchTerm = '') {
    moviesList.innerHTML = '';
    const filtered = movies.filter(m => m.title.toLowerCase().includes(searchTerm));
    if(filtered.length === 0) {
      moviesList.innerHTML = '<p style="grid-column:1/-1; text-align:center; color:#ccc;">No se encontraron películas.</p>';
      return;
    }
    filtered.forEach(movie => {
      moviesList.appendChild(createMovieCard(movie));
    });
  }

  renderMovies();

  // Accessibility: trap focus in modal when open
  document.addEventListener('keydown', (e) => {
    if(modalOverlay.style.display === 'flex') {
      if(e.key === 'Escape') {
        closePlayer();
      }
      const focusableElements = modalOverlay.querySelectorAll('a, button, [tabindex]:not([tabindex="-1"])');
      if (e.key === 'Tab') {
        // trap focus
        const first = focusableElements[0];
        const last = focusableElements[focusableElements.length - 1];
        if (e.shiftKey) {
          if(document.activeElement === first) {
            e.preventDefault();
            last.focus();
          }
        } else {
          if(document.activeElement === last) {
            e.preventDefault();
            first.focus();
          }
        }
      }
    }
  });
</script>
</body>
</html>
</content>
</create_file>
